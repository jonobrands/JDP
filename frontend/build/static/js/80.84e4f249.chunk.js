"use strict";(self.webpackChunkcasecon_frontend=self.webpackChunkcasecon_frontend||[]).push([[80],{80:(e,s,n)=>{n.r(s),n.d(s,{default:()=>d});var t=n(43),l=n(470),a=n(636),r=n(339),c=n(768),i=n(683),o=n(579);const d=function(e){let{onStatusUpdate:s}=e;const n=(0,l.c)(e=>e.jovieText),d=(0,l.c)(e=>e.setJovieText),[h,u]=(0,t.useState)(!1),[m,x]=(0,t.useState)(""),[g,b]=(0,t.useState)(!1),v=(0,l.c)(e=>e.jovieRows),p=(0,l.c)(e=>e.setJovieRows),[j,f]=(0,t.useState)(null),w=(0,a.W)();return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"bg-gray-50 border rounded p-4 mb-4",children:[(0,o.jsx)("label",{className:"block font-semibold mb-2",children:"Paste JOVIE data here (In Blocks)"}),(0,o.jsx)("textarea",{className:"w-full h-24 border rounded p-2 mb-4",value:n,onChange:e=>d(e.target.value)})]}),(0,o.jsxs)("div",{className:"flex gap-4 mb-4 items-center",children:[(0,o.jsx)("button",{className:"bg-orange-500 text-white px-6 py-2 rounded font-semibold hover:bg-orange-600",onClick:async()=>{u(!0),x("");try{const t=await c.FX(n);let l=(t.rows||[]).sort((e,s)=>(e.client||"").localeCompare(s.client||"")),a={clients:{},caregivers:{}};try{a=await c.I2(l)}catch(e){console.warn("JOVIE UID ensure failed, proceeding without enrichment",e)}const r=l.map(e=>{var s,n;return{...e,clientUID:(null===(s=a.clients)||void 0===s?void 0:s[String(e.client||"").trim()])||e.clientUID||"",caregiverUID:(null===(n=a.caregivers)||void 0===n?void 0:n[String(e.caregiver||"").trim()])||e.caregiverUID||""}});if(p(r),f(t.date||null),w.publish("jovie",{rows:r,date:t.date,uidSynced:!0,timestamp:(new Date).toISOString()}),console.log("Published JOVIE data to exchange store"),s){const e=t.date||null;s({message:`Processed ${r.length} JOVIE records`,count:r.length,date:e})}}catch(e){console.error("Error processing JOVIE data:",e),x("Failed to process JOVIE data"),f(null)}finally{u(!1)}},disabled:h,children:"Process"}),(0,o.jsx)("button",{className:"bg-gray-300 text-gray-800 px-6 py-2 rounded font-semibold hover:bg-gray-400",onClick:()=>{d(""),p([]),f(null),x(""),s&&s({message:"JOVIE cleared",count:0,date:null})},children:"Clear"}),(0,o.jsxs)("label",{className:"flex items-center gap-2 ml-2 text-sm",children:[(0,o.jsx)("input",{type:"checkbox",checked:g,onChange:e=>b(e.target.checked)}),(0,o.jsx)("span",{children:"Show UIDs"})]})]}),m&&(0,o.jsx)("div",{className:"text-red-600 mb-2",children:m}),(0,o.jsx)("div",{className:"overflow-x-auto border rounded bg-white mb-4 max-h-[350px] overflow-y-auto",children:(0,o.jsxs)("table",{className:"min-w-full text-sm",children:[(0,o.jsx)("thead",{className:"bg-gray-200",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"p-2 border font-bold",children:"#"}),(0,o.jsx)("th",{className:"p-2 border font-bold",children:"Client"}),(0,o.jsx)("th",{className:"p-2 border font-bold",children:"Caregiver"}),(0,o.jsx)("th",{className:"p-2 border font-bold",children:"Time"})]})}),(0,o.jsx)("tbody",{children:[...v].sort((e,s)=>(e.client||"").localeCompare(s.client||"")).map((e,s)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)(r.A,{children:s+1}),(0,o.jsxs)(r.A,{children:[e.client,g&&(0,o.jsxs)("span",{className:"text-gray-500 text-xs ml-2",children:["[",e.clientUID||e.client_uid||e.clientId||e.client_id||"","]"]})]}),(0,o.jsxs)(r.A,{children:[e.caregiver,g&&(0,o.jsxs)("span",{className:"text-gray-500 text-xs ml-2",children:["[",e.caregiverUID||e.caregiver_uid||e.caregiverId||e.caregiver_id||"","]"]})]}),(0,o.jsx)(r.A,{children:(0,i.$)(e.timeRange||e.time)})]},s))})]})})]})}},636:(e,s,n)=>{n.d(s,{W:()=>t});const t=(0,n(131).v)((e,s)=>({channels:{buca:null,jovie:null,uids:null,storage:null},publish:(s,n)=>{e(e=>({channels:{...e.channels,[s]:{...e.channels[s],...n,timestamp:(new Date).toISOString()}}}))},subscribe:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;return n=>t.subscribe(t=>{const l=t.channels[e];l&&n(s(l),l)},s)},clearChannel:s=>{e(e=>({channels:{...e.channels,[s]:null}}))},getChannelData:e=>s().channels[e]}));"undefined"!==typeof window&&(window.exchangeStore=t)}}]);
//# sourceMappingURL=80.84e4f249.chunk.js.map